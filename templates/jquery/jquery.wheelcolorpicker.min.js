/**
 * File: jquery.wheelcolorpicker.js
 * 
 * Version 1.1.0
 * 28 June 2011
 * 
 * JavaScript Wheel Color Picker
 * http://www.jar2.net/projects/jquery-wheelcolorpicker
 * 
 * 
 * Copyright Â© 2011 Fajar Yoseph Chandra. All rights reserved.
 * Licensed under MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * Usage example: $('input').wheelColorPicker();
 */
(function($){var s={dir:'http://static.jar2.net/files-public/jquery/wheelcolorpicker/',format:'hex',preview:true,userinput:true,validate:false};var t=null;var u=false;var v=false;var w={pr:1,pg:1,pb:1,val:1,sat:0,hue:0,r:255,g:255,b:255};var x={init:function(a){if(a)$.extend(s,a);$('head').prepend('<style type="text/css" id="jQWheelColorPickerCSS">'+'#jQWheelColorPickerDlg { '+'position: absolute !important;'+'border: solid 1px black;'+'width: 160px !important;'+'height: 134px !important;'+'padding: 8px !important;'+'background-color: #222;'+'z-index: 100000 !important;'+'box-shadow: 1px 1px 4px black;'+'cursor: default;'+'border-radius: 10px;'+'}'+'#jQWheelColorPickerDlgWheel {'+'position: absolute !important;'+'left: 8px !important;'+'top: 8px !important;'+'width: 134px !important;'+'height: 134px !important;'+'background: url("'+s.dir+'/wheel.png") no-repeat center center !important;'+'}'+'#jQWheelColorPickerDlgSlider {'+'position: absolute !important;'+'right: 8px !important;'+'top: 8px !important;'+'width: 16px !important;'+'height: 129px !important;'+'background-color: white;'+'border: solid 1px #111;'+'}'+'#jQWheelColorPickerDlgCross {'+'position: absolute !important;'+'background: url("'+s.dir+'/cross.png") no-repeat center center !important;'+'width: 11px !important;'+'height: 11px !important;'+'}'+'#jQWheelColorPickerDlgArrow {'+'position: absolute !important;'+'background: url("'+s.dir+'/arrow.png") no-repeat center center !important;'+'width: 7px !important;'+'height: 7px !important;'+'right: 26px !important;'+'top: 5px;'+'}'+'#jQWheelColorPickerDlgSlider .jqwcpSliderPoint {'+'position: relative !important;'+'width: 100% !important;'+'height: 3px !important;'+'}'+'</style>');return this.each(function(){$(this).bind('focus.wheelColorPicker',x.show);$(this).bind('blur.wheelColorPicker',x.hide);if(s.userinput){$(this).bind('keyup.wheelColorPicker',function(){if(x.updateColor($(this).val())){x.updateSelection();if(s.validate)$(this).wheelColorPicker("updateValue");else{if(s.preview){$(this).css('background-color','rgb('+w.r+', '+w.g+', '+w.b+')');$(this).css('color','rgb('+(255-w.r)+', '+(255-w.g)+', '+(255-w.b)+')')}}}})}$(this).wheelColorPicker('updateValue')})},destroy:function(){$("#jQWheelColorPickerCSS").remove();return this.each(function(){$(this).unbind('.wheelColorPicker')})},updateValue:function(){if(s.preview){$(this).css('background-color','rgb('+w.r+', '+w.g+', '+w.b+')');$(this).css('color','rgb('+(255-w.r)+', '+(255-w.g)+', '+(255-w.b)+')')}var a='';switch(s.format){case'css':a+='#';default:case'hex':var r=w.r.toString(16);if(r.length==1)r='0'+r;var g=w.g.toString(16);if(g.length==1)g='0'+g;var b=w.b.toString(16);if(b.length==1)b='0'+b;a+=r+g+b;break;case'rgb':a+='rgb('+w.r+','+w.g+','+w.b+')';break;case'rgba':a+='rgba('+rselectedColor.r+','+w.g+','+w.b+',1)';break}$(this).val(a)},updateColor:function(a){var r,g,b;if(a.length==7&&a.charAt(0)=='#'){if(isNaN(r=parseInt(a.substr(1,2),16)))return false;if(isNaN(g=parseInt(a.substr(3,2),16)))return false;if(isNaN(b=parseInt(a.substr(5,2),16)))return false}else if(a.length==6){if(isNaN(r=parseInt(a.substr(0,2),16)))return false;if(isNaN(g=parseInt(a.substr(2,2),16)))return false;if(isNaN(b=parseInt(a.substr(4,2),16)))return false}else if(a.substr(0,4)=='rgba'&&a.match(/rgba\s*\(\s*[0-9]{1,3}\s*,\s*[0-9]{1,3}\s*,\s*[0-9]{1,3}\s*,\s*[01]\.?[0-9]*\s*\)/i)!=null){if(isNaN(r=parseInt(a.substring(a.indexOf('(')+1,a.indexOf(',')),10)))return false;if(isNaN(g=parseInt(a.substring(a.indexOf(',')+1,a.indexOf(',',a.indexOf(',')+1)),10)))return false;if(isNaN(b=parseInt(a.substring(a.indexOf(',',a.indexOf(',')+1)+1,a.lastIndexOf(',')),10)))return false}else if(a.substr(0,3)=='rgb'&&a.match(/rgb\s*\(\s*[0-9]{1,3}\s*,\s*[0-9]{1,3}\s*,\s*[0-9]{1,3}\s*\)/i)!=null){if(isNaN(r=parseInt(a.substring(a.indexOf('(')+1,a.indexOf(',')),10)))return false;if(isNaN(g=parseInt(a.substring(a.indexOf(',')+1,a.indexOf(',',a.indexOf(',')+1)),10)))return false;if(isNaN(b=parseInt(a.substring(a.indexOf(',',a.indexOf(',')+1)+1,a.lastIndexOf(')')),10)))return false}else return false;w.r=r;w.g=g;w.b=b;var c=Math.max(r,g,b);var d=Math.min(r,g,b);var e=c-d;if(c!=0)w.sat=e/c;else w.sat=0;if(e==0)w.hue=0;else if(r==c)w.hue=(g-b)/e;else if(g==c)w.hue=2+(b-r)/e;else if(b==c)w.hue=4+(r-g)/e;else w.hue=0;w.hue=(w.hue*60+360)%360;w.val=c/255;if(w.val==0){w.pr=1;w.pg=1;w.pb=1}else{w.pr=r/255/w.val;w.pg=g/255/w.val;w.pb=b/255/w.val}return true},updateSlider:function(){var a=255/$('#jQWheelColorPickerDlgSlider').height();var b=$('#jQWheelColorPickerDlgSlider').height();$('#jQWheelColorPickerDlgSlider .jqwcpSliderPoint').each(function(){$(this).css('background-color','rgb('+Math.round(w.pr*a*b)+', '+Math.round(w.pg*a*b)+', '+Math.round(w.pb*a*b)+')');b-=3})},updateSelection:function(){var a=(1-w.val)*$('#jQWheelColorPickerDlgSlider').height()+parseInt($('#jQWheelColorPickerDlgSlider').css('top').replace('px',''),10)-$('#jQWheelColorPickerDlgArrow').outerHeight()/2;$('#jQWheelColorPickerDlgArrow').css('top',Math.round(a)+'px');var b=$('#jQWheelColorPickerDlgWheel').width()/2;var c=Math.cos(w.hue/180*Math.PI)*w.sat*b+b-$('#jQWheelColorPickerDlgCross').outerWidth()/2;$('#jQWheelColorPickerDlgCross').css('left',Math.round(c)+'px');var d=(Math.sin(w.hue/180*Math.PI)*w.sat*b)*-1+b-$('#jQWheelColorPickerDlgCross').outerHeight()/2;$('#jQWheelColorPickerDlgCross').css('top',Math.round(d)+'px');x.updateSlider()},show:function(e){x.hide(e,true);$('body').append('<div id="jQWheelColorPickerDlg" style="display: none;">'+'<div id="jQWheelColorPickerDlgWheel">'+'<span id="jQWheelColorPickerDlgCross">'+'</span>'+'</div>'+'<span id="jQWheelColorPickerDlgArrow">'+'</span>'+'<div id="jQWheelColorPickerDlgSlider">'+'</div>'+'</div>');var q=255/$('#jQWheelColorPickerDlgSlider').height();for(var i=$('#jQWheelColorPickerDlgSlider').height();i>=0;i-=3){$('#jQWheelColorPickerDlgSlider').append('<div class="jqwcpSliderPoint" style="background-color: rgb('+Math.round(q*i)+', '+Math.round(q*i)+', '+Math.round(q*i)+');">'+'</div>')}$('#jQWheelColorPickerDlgCross').css('left',($('#jQWheelColorPickerDlgWheel').width()/2+$('#jQWheelColorPickerDlgWheel').position().left-Math.ceil($('#jQWheelColorPickerDlgCross').width()/2))+'px');$('#jQWheelColorPickerDlgCross').css('top',($('#jQWheelColorPickerDlgWheel').height()/2+$('#jQWheelColorPickerDlgWheel').position().top-Math.ceil($('#jQWheelColorPickerDlgCross').height()/2))+'px');$('#jQWheelColorPickerDlg').bind('mousedown',function(){return false});$('#jQWheelColorPickerDlgWheel').bind('mousedown',function(){u=true});$('#jQWheelColorPickerDlgSlider').bind('mousedown',function(){v=true});$('#jQWheelColorPickerDlg').bind('mouseup',function(){u=false;v=false});$('#jQWheelColorPickerDlg').bind('mousemove mousedown',function(e){if(u){var a=$('#jQWheelColorPickerDlgWheel').width()/2;var b=e.pageX-$('#jQWheelColorPickerDlgWheel').offset().left;var c=e.pageY-$('#jQWheelColorPickerDlgWheel').offset().top;var d=b-a;var f=a-c;var g=Math.sqrt(Math.pow(d,2)+Math.pow(f,2));if(g>a){d=a/g*d;f=a/g*f;b=d+a;c=a-f;g=a}var h=((d==0?(f>0?90:270):360*(Math.atan(f/d))/(2*Math.PI))+(d<0?180:0)+360)%360;var i=g/a;var j=(Math.abs(h+360)+60)%360<120?1:(h>240?(120-Math.abs(h-360))/60:(h<120?(120-h)/60:0));var k=Math.abs(h-120)<60?1:(Math.abs(h-120)<120?(120-Math.abs(h-120))/60:0);var l=Math.abs(h-240)<60?1:(Math.abs(h-240)<120?(120-Math.abs(h-240))/60:0);var m=(j+(1-j)*(1-i));var n=(k+(1-k)*(1-i));var o=(l+(1-l)*(1-i));w.pr=m;w.pg=n;w.pb=o;w.r=(Math.round(w.pr*w.val*255));w.g=(Math.round(w.pg*w.val*255));w.b=(Math.round(w.pb*w.val*255));w.hue=h;w.sat=i;$('#jQWheelColorPickerDlgCross').css('left',(b-Math.ceil($('#jQWheelColorPickerDlgCross').width()/2))+'px');$('#jQWheelColorPickerDlgCross').css('top',(c-Math.ceil($('#jQWheelColorPickerDlgCross').height()/2))+'px');x.updateSlider();$(t).wheelColorPicker('updateValue')}if(v){var p=$('#jQWheelColorPickerDlgSlider').height();var c=e.pageY-$('#jQWheelColorPickerDlgSlider').offset().top;if(c<0){c=0}else if(c>p){c=p}w.val=(p-c)/p;w.r=Math.round(w.pr*w.val*255);w.g=Math.round(w.pg*w.val*255);w.b=Math.round(w.pb*w.val*255);$('#jQWheelColorPickerDlgArrow').css('top',(c-Math.ceil($('#jQWheelColorPickerDlgArrow').height()/2)+$('#jQWheelColorPickerDlgSlider').position().top)+'px');$(t).wheelColorPicker('updateValue')}});$(this).each(function(){t=this});$('#jQWheelColorPickerDlg').css('left',$(t).offset().left+'px');$('#jQWheelColorPickerDlg').css('top',($(t).offset().top+$(t).outerHeight())+'px');w.pr=1;w.pg=1;w.pb=1;w.val=1;w.hue=0;w.sat=0;w.r=255;w.g=255;w.b=255;if(x.updateColor($(t).val())){x.updateSelection()}$('#jQWheelColorPickerDlg').fadeIn('fast');return t},hide:function(e,a){if(a)$('#jQWheelColorPickerDlg').remove();else $('#jQWheelColorPickerDlg').fadeOut('fast',function(){$(this).remove()});u=false;v=false},};$.fn.wheelColorPicker=function(a){if(x[a]){return x[a].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof a==='object'||!a){return x.init.apply(this,arguments)}else{$.error('Method '+a+' does not exist on jQuery.wheelColorPicker')}}})(jQuery);
